## 如何保证mq的消息不被重复消费?

1.kafka

kafka有一个offset的概念,每个消息写进去,都有一个offset,代表该消息的序号,然后consumer消费了这个数据之后,每过一段时间会把自己已经消费过的offset提交一次

下次就算重启也是从上次消费的offset进行消费

意外: 消费过程中,kill了进程导致consumer消费了这个数据但是没有提交offset,这样就会出现重复消费

重复消费怎么解决?

保证幂等性即可

1. 插入类型,唯一索引
2. 写redis记录已经消费的msgid,如果重复的msgid不进行消费

