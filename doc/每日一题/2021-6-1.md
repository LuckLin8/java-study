# 2021/6/1-每日一题

## 算法:
### leetcode:反转字符串
https://leetcode-cn.com/problems/reverse-string/

## 题目:
在java中使用锁有哪些注意事项,如何进行锁优化?


减小锁的范围

加锁后可以确保一个方法或一段代码只有一个线程访问，因此锁定范围要尽可能小。比如使用 synchronized 时，能对代码块进行加锁，就尽量不要对方法进行加锁。



对象锁与类锁

能锁对象，就不要锁定类，尽量控制范围。锁定类以后，所有的线程使用同一把锁，同一时刻只有一个线程可以加锁；而锁定对象，可以增加锁的数量，提高并发的效率。



锁的公平性

大部分锁都支持设置公平性：公平锁是指按照线程等待的时间来决定哪个线程先获取锁，非公平锁是指随机选择一个线程来获取锁。重入锁和读写锁默认都是非公平锁，也可以通过参数来设置。使用时需要根据具体场景来决定设置公平或非公平。



锁消除

如无必要，不要使用锁。Java 虚拟机也可以根据逃逸分析判断出加锁的代码是否线程安全，如果确认线程安全虚拟机会进行锁消除提高效率。



锁粗化

如果一段代码需要使用多个锁，建议使用一把范围更大的锁来提高执行效率。Java 虚拟机也会进行优化，如果发现同一个对象锁有一系列的加锁解锁操作，虚拟机会进行锁粗化来降低锁的耗时